"use strict";(self["webpackChunkquick_csv_fix"]=self["webpackChunkquick_csv_fix"]||[]).push([[846],{3846:(e,t,s)=>{s.r(t),s.d(t,{default:()=>S});var l=s(3673);function o(e,t,s,o,a,i){const n=(0,l.up)("Table"),r=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(r,{class:"flex flex-center q-pa-md"},{default:(0,l.w5)((()=>[(0,l._)("div",null,[(0,l.Wm)(n)])])),_:1})}s(7280),s(5363);const a={class:"q-pa-md "},i={class:"flex justify-between"},n={key:0,class:"text-primary"},r=(0,l.Uk)(" change view: ");function c(e,t,s,o,c,p){const u=(0,l.up)("Uploader"),d=(0,l.up)("q-btn"),m=(0,l.up)("q-select"),v=(0,l.up)("q-icon"),f=(0,l.up)("q-input"),h=(0,l.up)("q-badge"),b=(0,l.up)("q-td"),g=(0,l.up)("q-table");return(0,l.wg)(),(0,l.iD)("div",a,[(0,l._)("div",i,[(0,l.Wm)(u),o.store.state.collumnsCsv?((0,l.wg)(),(0,l.iD)("div",n,[r,(0,l.Wm)(d,{color:"primary",flat:"",label:this.store.state.grid?"grid":"table","no-caps":"",onClick:t[0]||(t[0]=e=>this.store.state.grid=!this.store.state.grid)},null,8,["label"])])):(0,l.kq)("",!0),o.store.state.collumnsCsv?((0,l.wg)(),(0,l.j4)(d,{key:1,color:"primary",flat:"","icon-right":"archive",class:"absolute-top-right",label:"Export","no-caps":"",onClick:p.exportTable},null,8,["onClick"])):(0,l.kq)("",!0)]),o.store.state.collumnsCsv?((0,l.wg)(),(0,l.j4)(g,{key:0,grid:this.store.state.grid,"card-class":this.store.state.grid?"bg-primary text-white":"",style:{"max-width":"1000px"},title:o.store.state.fileName.replace(".csv",""),dense:"",rows:o.store.state.rowsCsv,"row-key":o.store.state.collumnsCsv[0].name,filter:o.filter,pagination:o.store.state.initialPagination,"onUpdate:pagination":t[3]||(t[3]=e=>o.store.state.initialPagination=e),"visible-columns":o.store.state.visibleColumns},{"top-right":(0,l.w5)((()=>[(0,l.Wm)(m,{modelValue:o.store.state.visibleColumns,"onUpdate:modelValue":t[1]||(t[1]=e=>o.store.state.visibleColumns=e),multiple:"",outlined:"",dense:"","options-dense":"","display-value":e.$q.lang.table.columns,"emit-value":"","map-options":"",options:o.store.state.collumnsCsv,"option-value":"name","options-cover":"",style:{"min-width":"150px"},class:"q-pr-xl"},null,8,["modelValue","display-value","options"]),(0,l.Wm)(f,{borderless:"",dense:"",debounce:"300",modelValue:o.filter,"onUpdate:modelValue":t[2]||(t[2]=e=>o.filter=e),placeholder:"Search"},{append:(0,l.w5)((()=>[(0,l.Wm)(v,{name:"search"})])),_:1},8,["modelValue"])])),"body-cell":(0,l.w5)((e=>[(0,l.Wm)(b,{props:e},{default:(0,l.w5)((()=>[(0,l.Wm)(h,{color:"blue",label:e.value},null,8,["label"])])),_:2},1032,["props"])])),_:1},8,["grid","card-class","title","rows","row-key","filter","pagination","visible-columns"])):(0,l.kq)("",!0)])}var p=s(2841),u=s(8825);function d(e,t,s,o,a,i){const n=(0,l.up)("q-icon"),r=(0,l.up)("q-file");return(0,l.wg)(),(0,l.j4)(r,{accept:"csv",style:{"max-width":"300px"},modelValue:o.filesCsv,"onUpdate:modelValue":t[0]||(t[0]=e=>o.filesCsv=e),clearable:"",icon:"home",label:"  Upload csv",multiple:"",filter:o.checkFileType,onRejected:o.onRejected},(0,l.Nv)({_:2},[o.filesCsv?void 0:{name:"prepend",fn:(0,l.w5)((()=>[(0,l.Wm)(n,{name:"upload"})]))}]),1032,["modelValue","filter","onRejected"])}s(71);var m=s(1959);const v={setup(){const e=(0,u.Z)(),t=(0,l.f3)("csvStore");return{store:t,filesMaxSize:(0,m.iH)(null),filesCsv:(0,m.iH)(null),checkFileSize(e){return e.filter((e=>e.size<2048))},checkFileType(e){return e.filter((e=>"text/csv"===e.type))},onRejected(t){e.notify({type:"negative",message:`${t.length} file(s) did not pass validation constraints`})}}},watch:{filesCsv(e){e&&e[0].text().then((t=>{this.store.state.fileName=e[0].name;const s=t.split("\n"),l=s[0].split(","),o=[];for(var a=0;a<l.length;a++)l[a]&&(0==a?o.push({name:l[a],required:!0,label:l[a],align:"left",field:e=>e.name,format:e=>`${e}`,sortable:!0}):o.push({name:l[a],label:l[a],field:l[a],sortable:!0}));this.store.state.collumnsCsv=o,this.store.state.visibleColumns=[...o],this.store.state.visibleColumns=this.store.state.visibleColumns.map((e=>e.name));const i=[];for(a=1;a<s.length;a++){let e=new Object;for(var n=0;n<s[a].length;n++){let t=l[n],o=s[a].split(",")[n];isNaN(o)||(o=Number(o)),t&&(e[t]=o)}0===Object.keys(e).length||i.push(e)}this.store.state.rowsCsv=i}))}}};var f=s(4974),h=s(4554),b=s(7518),g=s.n(b);v.render=d;const w=v;function C(e,t){let s=void 0!==t?t(e):e;return s=void 0===s||null===s?"":String(s),s=s.split('"').join('""'),`"${s}"`}g()(v,"components",{QFile:f.Z,QIcon:h.Z});const y={components:{Uploader:w},setup(){(0,u.Z)();return{store:(0,l.f3)("csvStore"),filter:(0,m.iH)("")}},methods:{exportTable(){const e=[this.store.state.collumnsCsv.map((e=>C(e.label)))].concat(this.store.state.rowsCsv.map((e=>this.store.state.collumnsCsv.map((t=>C("function"===typeof t.field?t.field(e):e[void 0===t.field?t.name:t.field],t.format))).join(",")))).join("\r\n"),t=(0,p.Z)(this.store.state.fileName,e,"text/csv");!0!==t&&$q.notify({message:"Browser denied file download...",color:"negative",icon:"warning"})}}};var k=s(4607),q=s(6593),x=s(4788),j=s(4689),Z=s(3884),_=s(9721);y.render=c;const Q=y;g()(y,"components",{QBtn:k.Z,QTable:q.Z,QSelect:x.Z,QInput:j.Z,QIcon:h.Z,QTd:Z.Z,QBadge:_.Z});const V=(0,l.aZ)({name:"PageIndex",components:{Table:Q},setup(){const e=(0,l.f3)("csvStore");return{store:e}}});var W=s(4379);V.render=o;const S=V;g()(V,"components",{QPage:W.Z})}}]);